<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.spam.persistence.AttendanceMapper">
	<resultMap id="attendanceResultMap" type="attendance">
		<id column="ATTENDANCE_NO" property="attendanceNo" />
		<result column="TITLE" property="title" />
		<result column="REGISTRATION_DATE" property="registrationDate" />
		<result column="LECTURE_DATE" property="lectureDate" />
		<result column="LECTURE_TIME" property="lectureTime" />
		<result column="LOCATION" property="location" />
		<result column="SCORE" property="score" />
		<result column="UPLOAD_FILE_NAME" property="uploadFileName" />
		<result column="MAKED_FILE_NAME" property="makedFileName" />
		<result column="FILES_LOCATION" property="filesLocation" />
	</resultMap>
	
<!-- 
	<select id="select" parameterType="spamuser" resultMap="spamuserResultMap">
		SELECT   ID
			   , PASSWORD
			   , POWER
			   , NAME 
			   , GRADE
			   , MAJOR
			   , PHONE_NO
			   , BIRTH_DATE
			   , OFFICE
			   , EMP_NO
			   , GR_NO
			   , CARD_NO
			   , ENROLLMENT_NO
		FROM SPAM_USER
		<where>
			<if test="id != null and id !=''">
				AND ID = #{id}
			</if>
			<if test="passWord != null and passWord != ''" >
				AND PASSWORD = #{passWord}
			</if>
			<if test="power != null and power != ''">
				AND POWER = #{power}
			</if>
			<if test="name != null and name != ''" >
				AND NAME = #{name}
			</if>
			<if test="birthDate != null and birthDate != ''">
				AND BIRTH_DATE = #{birthDate}
			</if>
			<if test="office != null and office != ''">
				AND OFFICE = #{office}
			</if>
			<if test="empForm != null and empForm != ''">
				AND EMP_FORM = #{empForm}
			</if>
			<if test="grForm != null and grForm != ''">
				AND GR_FORM = #{grForm}
			</if>
			<if test="cardNo != null and cardNo != ''">
				AND CARD_NO = #{cardNo}
			</if>
			
		</where>
	</select>
	
	!-->
	
	<insert id="insertAttendance" parameterType="attendance"
		useGeneratedKeys="true" keyProperty="attendanceNo" keyColumn="attendanceNo">
		<selectKey keyColumn="ATTENDANCE_NO" keyProperty="attendanceNo"
			resultType="int" order="BEFORE">
				SELECT ATTENDANCE_NO_SEQ.NEXTVAL
				FROM DUAL
		</selectKey>
		
		INSERT INTO ATTENDANCE
		(ATTENDANCE_NO,
		TITLE, 
		REGISTRATION_DATE, 
		LECTURE_DATE, 
		LECTURE_TIME, 
		LOCATION, 
		SCORE, 
		UPLOAD_FILE_NAME, 
		MAKED_FILE_NAME, 
		FILES_LOCATION)
		
		VALUES
		(#{attendanceNo},
		#{title},
		#{registrationDate},
		#{lectureDate},
		#{lectureTime},
		#{location},
		#{score},
		#{uploadFileName},
		#{makedFileName},
		#{filesLocation})
	</insert>
	
	<!-- 
	<insert id="insertAttendanceStudentInfo" parameterType="attendance"
		useGeneratedKeys="true" keyProperty="attendanceNo" keyColumn="attendanceNo">
		<selectKey keyColumn="ATTENDANCE_NO" keyProperty="attendanceNo"
			resultType="int" order="BEFORE">
				SELECT ATTENDANCE_NO_SEQ.CURRVAL
				FROM DUAL
		</selectKey>
		
		INSERT INTO ATTEND
		(ATTEND_NO,
		ATTENDANCE_NO, 
		ID 
		)
		
		VALUES
		(#{attendanceNo},
		#{title},
		#{registrationDate})
	</insert>
	 -->

</mapper>